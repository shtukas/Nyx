#!/usr/bin/ruby

# encoding: UTF-8

require_relative "Libs/loader.rb"

# ----------------------------------------------------------------------------

loop {
    puts "-- Nyx ðŸ—º -----------------------------"

    ops = [
        "Search",
        "Nodes Listing",
        "Tags Listing",
        "Make new Quark",
    ]
    operation = LucilleCore::selectEntityFromListOfEntitiesOrNull("operation", ops)
    break if operation.nil?
    if operation == "Search" then
        Patricia::generalSearchLoop()
    end
    if operation == "Nodes Listing" then
        loop {
            quarks = Patricia::networkNodesInOrder()
            quark = LucilleCore::selectEntityFromListOfEntitiesOrNull("quark", quarks, lambda{|e| Quarks::toString(e) })
            break if quark.nil?
            Quarks::landing(quark)
        }
    end
    if operation == "Tags Listing" then
        loop {
            values = Tags::getDistinctTags().sort
            value = LucilleCore::selectEntityFromListOfEntitiesOrNull("value", values)
            break if value.nil?
            Tags::landing(value)
        }
    end
    if operation == "Make new Quark" then
        quark = Quarks::interactivelyIssueNewQuarkOrNull()
        next if quark.nil?
        Quarks::landing(quark)
    end
}
