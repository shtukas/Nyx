#!/usr/bin/ruby

# encoding: UTF-8

require_relative "Libs/loader.rb"

# ----------------------------------------------------------------------------

if ARGV[0] == "search" then
    Space::generalSearchLoop()
    exit
end

if ARGV[0] == "listing" then
    loop {
        nxpoint = LucilleCore::selectEntityFromListOfEntitiesOrNull("NxPoint", Space::getNxPoints(), lambda{|e| e.toString() })
        break if nxpoint.nil?
        Space::landing(nxpoint)
    }
    exit
end

if ARGV[0] == "make" then
    nxpoint = Space::interactivelyMakeNewNxPointOrNull()
    exit if nxpoint.nil?
    Space::landing(nxpoint)
    exit
end

if ARGV[0] == "unique-string" then
    puts SecureRandom.hex(6)
    exit
end

if ARGV[0] == "fsck" then
    NxPods::getNxPods().each{|nxpod|
        puts nxpod.id()
        NxPods::fsckNxPod(nxpod.id())
    }
    NxNavs::getNxNavs().each{|nxnav|
        puts nxnav.id()
        NxNavs::fsckNxNav(nxnav.id())
    }
    puts "All good!".green
    exit
end

str = <<HELP
usage:
    nyx search
    nyx listing
    nyx make
    nyx unique-string # Generates a unique string for type FSUniqueString
    nyx fsck
    nyx help # help display
HELP
puts str

