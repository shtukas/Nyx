#!/usr/bin/ruby

# encoding: UTF-8

require_relative "Libs/loader.rb"

# ----------------------------------------------------------------------------

if ARGV[0] == "search" then
    Search::searchLoopNetworkNxQuarks()
    exit
end

if ARGV[0] == "listing" then
    loop {
        id = LucilleCore::selectEntityFromListOfEntitiesOrNull("NxQuark", NxEntities::ids(), lambda{|id| NxQuarks::description(id) })
        break if id.nil?
        NxQuarks::landing(id)
    }
    exit
end

if ARGV[0] == "make" then
    id = NxQuarks::interactivelyMakeNewNxQuarkReturnIdOrNull()
    exit if id.nil?
    NxQuarks::landing(id)
    exit
end

if ARGV[0] == "unique-string" then
    puts SecureRandom.hex(6)
    exit
end

if ARGV[0] == "fsck" then
    NxEntities::ids().each{|id|
        puts "fsck: #{id}"
        NxQuarks::fsck(id)
    }
    puts "All good!".green
    exit
end

str = <<HELP
usage:
    nyx search
    nyx listing
    nyx make
    nyx unique-string # Generates a unique string for type FSUniqueString
    nyx fsck
    nyx help # help display
HELP
puts str

